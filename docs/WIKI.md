# SwiftMTP é¡¹ç›® WIKI

## ğŸ“‘ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
  - [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
  - [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
  - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
  - [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
  - [æ•°æ®æµ](#æ•°æ®æµ)
  - [çº¿ç¨‹æ¨¡å‹](#çº¿ç¨‹æ¨¡å‹)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
  - [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
  - [å®‰è£…æ­¥éª¤](#å®‰è£…æ­¥éª¤)
  - [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
  - [è¯¦ç»†æ“ä½œ](#è¯¦ç»†æ“ä½œ)
  - [é…ç½®é€‰é¡¹](#é…ç½®é€‰é¡¹)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
  - [å¼€å‘ç¯å¢ƒæ­å»º](#å¼€å‘ç¯å¢ƒæ­å»º)
  - [æ„å»ºæµç¨‹](#æ„å»ºæµç¨‹)
  - [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
  - [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
  - [CGO æ¡¥æ¥ API](#cgo-æ¡¥æ¥-api)
  - [Swift æœåŠ¡å±‚ API](#swift-æœåŠ¡å±‚-api)
  - [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
- [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”-faq)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)

---

## é¡¹ç›®æ¦‚è¿°

### ç®€ä»‹

SwiftMTP æ˜¯ä¸€æ¬¾ä¸“ä¸º macOS å¹³å°è®¾è®¡çš„åŸç”Ÿ Android MTP æ–‡ä»¶ä¼ è¾“å·¥å…·ã€‚å®ƒé€šè¿‡ USB è¿æ¥å®ç° Mac ä¸ Android è®¾å¤‡ä¹‹é—´çš„é«˜æ•ˆæ–‡ä»¶ä¼ è¾“ï¼Œæä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒå’Œç°ä»£åŒ–çš„ç•Œé¢è®¾è®¡ã€‚

### é¡¹ç›®ç›®æ ‡

- **åŸç”Ÿä½“éªŒ**: ä½¿ç”¨ SwiftUI æ„å»ºï¼Œæä¾›åŸç”Ÿ macOS åº”ç”¨ä½“éªŒ
- **é«˜æ•ˆä¼ è¾“**: ä¼˜åŒ– MTP åè®®å®ç°ï¼Œæ”¯æŒå¤§æ–‡ä»¶ä¼ è¾“ï¼ˆ>4GBï¼‰
- **æ˜“ç”¨æ€§**: è‡ªåŠ¨è®¾å¤‡æ£€æµ‹ã€ç›´è§‚çš„æ–‡ä»¶æµè§ˆç•Œé¢
- **å›½é™…åŒ–**: æ”¯æŒå¤šè¯­è¨€ï¼ˆç®€ä½“ä¸­æ–‡ã€è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­ï¼‰
- **ç¨³å®šæ€§**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**: 1.0.0
- **æœ€ä½ç³»ç»Ÿè¦æ±‚**: macOS 26.0
- **æ”¯æŒçš„ Android ç‰ˆæœ¬**: Android 4.0+ (MTP æ¨¡å¼)

### è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](../LICENSE) æ–‡ä»¶

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. è®¾å¤‡è‡ªåŠ¨æ£€æµ‹

- **è‡ªåŠ¨æ‰«æ**: åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹è¿æ¥çš„ Android è®¾å¤‡
- **å®æ—¶æ›´æ–°**: è®¾å¤‡è¿æ¥/æ–­å¼€æ—¶å®æ—¶æ›´æ–°çŠ¶æ€
- **æ™ºèƒ½é‡è¯•**: æŒ‡æ•°é€€é¿ç­–ç•¥ä¼˜åŒ–æ‰«æé¢‘ç‡
- **æ‰‹åŠ¨åˆ·æ–°**: æ”¯æŒæ‰‹åŠ¨è§¦å‘è®¾å¤‡æ‰«æ

### 2. æ–‡ä»¶æµè§ˆ

- **æ ‘å½¢æµè§ˆ**: æ”¯æŒæ–‡ä»¶å¤¹å±‚çº§æµè§ˆ
- **é¢åŒ…å±‘å¯¼èˆª**: å¿«é€Ÿè¿”å›ä¸Šçº§ç›®å½•
- **æ–‡ä»¶è¯¦æƒ…**: æ˜¾ç¤ºæ–‡ä»¶åã€å¤§å°ã€ä¿®æ”¹æ—¥æœŸ
- **æ™ºèƒ½æ’åº**: æŒ‰åç§°ã€å¤§å°ã€æ—¥æœŸæ’åº
- **ç¼“å­˜æœºåˆ¶**: 60ç§’ç¼“å­˜æå‡æµè§ˆé€Ÿåº¦

### 3. æ–‡ä»¶ä¸‹è½½

- **å•æ–‡ä»¶ä¸‹è½½**: å³é”®èœå•å¿«é€Ÿä¸‹è½½
- **æ‰¹é‡ä¸‹è½½**: å¤šé€‰æ–‡ä»¶æ‰¹é‡ä¸‹è½½
- **å¤§æ–‡ä»¶æ”¯æŒ**: æ”¯æŒ >4GB æ–‡ä»¶ä¸‹è½½
- **æ–­ç‚¹ç»­ä¼ **: å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼‰
- **è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºä¸‹è½½è¿›åº¦
- **æ–‡ä»¶éªŒè¯**: ä¸‹è½½åéªŒè¯æ–‡ä»¶å®Œæ•´æ€§

### 4. æ–‡ä»¶ä¸Šä¼ 

- **æŒ‰é’®ä¸Šä¼ **: å·¥å…·æ æŒ‰é’®é€‰æ‹©æ–‡ä»¶
- **æ‹–æ”¾ä¸Šä¼ **: ç›´æ¥æ‹–æ”¾æ–‡ä»¶åˆ°çª—å£
- **è¾“å…¥éªŒè¯**: 7æ­¥å®‰å…¨éªŒè¯æœºåˆ¶
- **ç©ºé—´æ£€æŸ¥**: è‡ªåŠ¨æ£€æŸ¥è®¾å¤‡å­˜å‚¨ç©ºé—´
- **ä¸Šä¼ ååˆ·æ–°**: è‡ªåŠ¨åˆ·æ–°æ–‡ä»¶åˆ—è¡¨

### 5. æ‰¹é‡æ“ä½œ

- **å¤šé€‰æ”¯æŒ**: Command+Click å¤šé€‰æ–‡ä»¶
- **æ‰¹é‡ä¸‹è½½**: ä¸€æ¬¡ä¸‹è½½å¤šä¸ªæ–‡ä»¶
- **è¿›åº¦è·Ÿè¸ª**: å®æ—¶è·Ÿè¸ªæ‰€æœ‰ä¼ è¾“ä»»åŠ¡

### 6. å­˜å‚¨ä¿¡æ¯

- **å®¹é‡æ˜¾ç¤º**: æ˜¾ç¤ºè®¾å¤‡æ€»å®¹é‡å’Œå¯ç”¨ç©ºé—´
- **ä½¿ç”¨ç‡**: å¯è§†åŒ–æ˜¾ç¤ºå­˜å‚¨ä½¿ç”¨ç™¾åˆ†æ¯”
- **å¤šå­˜å‚¨æ”¯æŒ**: æ”¯æŒå¤šä¸ªå­˜å‚¨åˆ†åŒºï¼ˆå¦‚å†…éƒ¨å­˜å‚¨ã€SDå¡ï¼‰

### 7. å¤šè¯­è¨€æ”¯æŒ

- **è¯­è¨€é€‰æ‹©**: ç®€ä½“ä¸­æ–‡ã€è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­
- **ç³»ç»Ÿè·Ÿéš**: è‡ªåŠ¨è·Ÿéšç³»ç»Ÿè¯­è¨€
- **å³æ—¶åˆ‡æ¢**: åº”ç”¨å†…å³æ—¶åˆ‡æ¢è¯­è¨€
- **å®Œæ•´æœ¬åœ°åŒ–**: åŒ…æ‹¬èœå•æ ã€æ–‡ä»¶é€‰æ‹©å™¨

### 8. ç°ä»£åŒ– UI

- **SwiftUI**: ä½¿ç”¨æœ€æ–° SwiftUI æ¡†æ¶
- **Material Design**: ç°ä»£åŒ–è®¾è®¡é£æ ¼
- **å“åº”å¼å¸ƒå±€**: è‡ªé€‚åº”çª—å£å¤§å°
- **æš—è‰²æ¨¡å¼**: æ”¯æŒç³»ç»Ÿæš—è‰²æ¨¡å¼

---

## æŠ€æœ¯æ¶æ„

### æ¶æ„è®¾è®¡

SwiftMTP é‡‡ç”¨ **MVVM (Model-View-ViewModel)** æ¶æ„æ¨¡å¼ï¼Œç»“åˆ **Combine** æ¡†æ¶å®ç°å“åº”å¼æ•°æ®æµã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SwiftUI Views                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ DeviceList   â”‚  â”‚ FileBrowser  â”‚  â”‚ FileTransfer â”‚      â”‚
â”‚  â”‚    View      â”‚  â”‚    View      â”‚  â”‚    View      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                           â”‚                                 â”‚
â”‚                           â–¼                                 â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                  â”‚ MainWindow    â”‚                          â”‚
â”‚                  â”‚    View       â”‚                          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Services Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Device     â”‚  â”‚  FileSystem  â”‚  â”‚  FileTransferâ”‚      â”‚
â”‚  â”‚  Manager     â”‚  â”‚   Manager    â”‚  â”‚   Manager    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                           â”‚                                 â”‚
â”‚                           â–¼                                 â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                  â”‚   Language    â”‚                          â”‚
â”‚                  â”‚   Manager     â”‚                          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Models Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Device     â”‚  â”‚   FileItem   â”‚  â”‚ TransferTask â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CGO Bridge                             â”‚
â”‚                  (Swift â†” C â†” Go)                            â”‚
â”‚                  Kalam Bridge                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Go Kernel                               â”‚
â”‚              (MTP Protocol Implementation)                    â”‚
â”‚                    go-mtpx + libusb                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

#### å‰ç«¯ (Swift)

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Swift | 5.9+ | ä¸»è¦å¼€å‘è¯­è¨€ |
| SwiftUI | iOS 17+ | UI æ¡†æ¶ |
| Combine | iOS 13+ | å“åº”å¼ç¼–ç¨‹ |
| Foundation | - | åŸºç¡€æ¡†æ¶ |

#### åç«¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Go | 1.22+ | æ¡¥æ¥å±‚å®ç° |
| CGO | - | Swift â†” Go æ¡¥æ¥ |

#### ä¾èµ–åº“

| åº“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| go-mtpx | - | MTP åè®®å®ç° |
| libusb-1.0 | - | USB è®¾å¤‡é€šä¿¡ |

### é¡¹ç›®ç»“æ„

```
SwiftMTP/
â”œâ”€â”€ Native/                         # Go æ¡¥æ¥å±‚
â”‚   â”œâ”€â”€ kalam_*.go                 # åˆ†æ¨¡å— CGO æ¡¥æ¥å®ç°
â”‚   â”œâ”€â”€ *_test.go                  # æŒ‰æ¨¡å—åˆ’åˆ†çš„ Go å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ libkalam.h                 # C å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ go.mod                     # Go æ¨¡å—å®šä¹‰
â”‚   â”œâ”€â”€ go.sum                     # Go ä¾èµ–é”å®š
â”‚   â””â”€â”€ vendor/                    # Go ä¾èµ–
â”‚       â””â”€â”€ github.com/
â”‚           â””â”€â”€ ganeshrvel/
â”‚               â”œâ”€â”€ go-mtpfs/      # MTP æ–‡ä»¶ç³»ç»Ÿ
â”‚               â”œâ”€â”€ go-mtpx/       # MTP åè®®æ‰©å±•
â”‚               â””â”€â”€ usb/           # USB é©±åŠ¨
â”‚
â”œâ”€â”€ Scripts/                        # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build_kalam.sh             # æ„å»º Go åŠ¨æ€åº“
â”‚   â”œâ”€â”€ create_dmg.sh              # åˆ›å»º DMG å®‰è£…åŒ…
â”‚   â”œâ”€â”€ create_dmg_simple.sh       # ç®€åŒ–ç‰ˆæ‰“åŒ…
â”‚   â”œâ”€â”€ generate_icons.sh          # ç”Ÿæˆåº”ç”¨å›¾æ ‡
â”‚   â”œâ”€â”€ run_tests.sh               # è¿è¡Œæµ‹è¯•
â”‚   â””â”€â”€ fix_xcode_path.sh          # ä¿®å¤ Xcode è·¯å¾„
â”‚
â”œâ”€â”€ SwiftMTP/                       # Swift åº”ç”¨
â”‚   â”œâ”€â”€ App/                       # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ SwiftMTPApp.swift      # åº”ç”¨ä¸»ç±»
â”‚   â”‚   â”œâ”€â”€ Info.plist             # åº”ç”¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ Assets.xcassets/       # èµ„æºæ–‡ä»¶
â”‚   â”‚   â””â”€â”€ Resources/             # åº”ç”¨èµ„æº
â”‚   â”‚       â””â”€â”€ SwiftMTP_Logo.svg  # åº”ç”¨ Logo
â”‚   â”‚
â”‚   â”œâ”€â”€ Models/                    # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Device.swift           # è®¾å¤‡æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ FileItem.swift         # æ–‡ä»¶æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ TransferTask.swift     # ä¼ è¾“ä»»åŠ¡æ¨¡å‹
â”‚   â”‚   â””â”€â”€ AppLanguage.swift      # è¯­è¨€æšä¸¾
â”‚   â”‚
â”‚   â”œâ”€â”€ Services/                  # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ LanguageManager.swift  # è¯­è¨€ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ LocalizationManager.swift # æœ¬åœ°åŒ–ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ MTP/                   # MTP æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ DeviceManager.swift    # è®¾å¤‡ç®¡ç†
â”‚   â”‚       â”œâ”€â”€ FileSystemManager.swift# æ–‡ä»¶ç³»ç»Ÿç®¡ç†
â”‚   â”‚       â”œâ”€â”€ FileTransferManager.swift # æ–‡ä»¶ä¼ è¾“ç®¡ç†
â”‚   â”‚       â””â”€â”€ FileTransferManager+DirectoryUpload.swift # ç›®å½•ä¸Šä¼ æ‰©å±•
â”‚   â”‚
â”‚   â”œâ”€â”€ Views/                     # SwiftUI è§†å›¾
â”‚   â”‚   â”œâ”€â”€ MainWindowView.swift   # ä¸»çª—å£
â”‚   â”‚   â”œâ”€â”€ DeviceListView.swift   # è®¾å¤‡åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ FileBrowserView.swift  # æ–‡ä»¶æµè§ˆå™¨
â”‚   â”‚   â”œâ”€â”€ FileBrowserView+Actions.swift # æ–‡ä»¶æµè§ˆæ“ä½œ
â”‚   â”‚   â”œâ”€â”€ FileBrowserView+ToolbarDrop.swift # æ–‡ä»¶æµè§ˆå·¥å…·æ ä¸æ‹–æ‹½
â”‚   â”‚   â”œâ”€â”€ TableDoubleClickModifier.swift # è¡¨æ ¼åŒå‡»æ¡¥æ¥
â”‚   â”‚   â”œâ”€â”€ FileTransferView.swift # ä¼ è¾“è§†å›¾
â”‚   â”‚   â”œâ”€â”€ SettingsView.swift     # è®¾ç½®çª—å£
â”‚   â”‚   â””â”€â”€ Components/            # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ DeviceRowView.swift
â”‚   â”‚       â”œâ”€â”€ LiquidGlassView.swift
â”‚   â”‚       â””â”€â”€ TransferTaskRowView.swift
â”‚   â”‚
â”‚   â”œâ”€â”€ Resources/                 # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ Base.lproj/            # åŸºç¡€è¯­è¨€åŒ…
â”‚   â”‚   â”œâ”€â”€ en.lproj/              # è‹±æ–‡è¯­è¨€åŒ…
â”‚   â”‚   â”œâ”€â”€ zh-Hans.lproj/         # ç®€ä½“ä¸­æ–‡è¯­è¨€åŒ…
â”‚   â”‚   â”œâ”€â”€ ja.lproj/              # æ—¥è¯­è¯­è¨€åŒ…
â”‚   â”‚   â””â”€â”€ ko.lproj/              # éŸ©è¯­è¯­è¨€åŒ…
â”‚   â”‚
â”‚   â”œâ”€â”€ libkalam.dylib             # Go åŠ¨æ€åº“
â”‚   â”œâ”€â”€ libkalam.h                 # C æ¡¥æ¥å¤´æ–‡ä»¶
â”‚   â””â”€â”€ SwiftMTP-Bridging-Header.h # Swift-C æ¡¥æ¥å¤´æ–‡ä»¶
â”‚
â”œâ”€â”€ SwiftMTP.xcodeproj/            # Xcode é¡¹ç›®
â”œâ”€â”€ build/                         # æ„å»ºè¾“å‡º
â”œâ”€â”€ docs/                          # æ–‡æ¡£
â”‚   â”œâ”€â”€ WIKI.md                    # æœ¬æ–‡æ¡£
â”‚   â”œâ”€â”€ sequence-diagrams.md       # æ—¶åºå›¾
â”‚   â””â”€â”€ TESTING.md                 # æµ‹è¯•æ–‡æ¡£
â”‚
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ LICENSE                        # MIT è®¸å¯è¯
â””â”€â”€ setup-check.sh                 # ç¯å¢ƒæ£€æŸ¥è„šæœ¬
```

### æ ¸å¿ƒç»„ä»¶

#### 1. DeviceManager (è®¾å¤‡ç®¡ç†å™¨)

**èŒè´£**:
- è®¾å¤‡è‡ªåŠ¨æ£€æµ‹å’Œæ‰«æ
- è®¾å¤‡è¿æ¥çŠ¶æ€ç®¡ç†
- è®¾å¤‡ä¿¡æ¯ç¼“å­˜
- è®¾å¤‡æ–­å¼€æ£€æµ‹

**å…³é”®æ–¹æ³•**:
```swift
// å•ä¾‹è®¿é—®
static let shared = DeviceManager()

// å¼€å§‹æ‰«æè®¾å¤‡
func startScanning()

// åœæ­¢æ‰«æè®¾å¤‡
func stopScanning()

// æ‰‹åŠ¨åˆ·æ–°è®¾å¤‡
func manualRefresh()

// è·å–è®¾å¤‡åˆ—è¡¨
@Published var devices: [Device]

// å½“å‰é€‰ä¸­çš„è®¾å¤‡
@Published var selectedDevice: Device?
```

**æ‰«æç­–ç•¥**:
- **åˆå§‹é—´éš”**: ç”¨æˆ·è®¾ç½®çš„å€¼ï¼ˆé»˜è®¤3ç§’ï¼‰
- **æŒ‡æ•°é€€é¿**: å¤±è´¥åé—´éš” = min(userScanInterval Ã— 2^failures, 30ç§’)
- **æœ€å¤§å¤±è´¥æ¬¡æ•°**: 3æ¬¡
- **æ‰‹åŠ¨åˆ·æ–°**: é‡ç½®å¤±è´¥è®¡æ•°å’Œæ‰«æé—´éš”
- **ç”¨æˆ·é…ç½®**: å¯åœ¨è®¾ç½®ä¸­è°ƒæ•´æ‰«æé—´éš”ï¼ˆ1-10ç§’ï¼‰

#### 2. FileSystemManager (æ–‡ä»¶ç³»ç»Ÿç®¡ç†å™¨)

**èŒè´£**:
- æ–‡ä»¶åˆ—è¡¨è·å–å’Œç¼“å­˜
- æ–‡ä»¶å¤¹å±‚çº§æµè§ˆ
- æ–‡ä»¶ä¿¡æ¯æŸ¥è¯¢
- ç¼“å­˜ç®¡ç†

**å…³é”®æ–¹æ³•**:
```swift
// å•ä¾‹è®¿é—®
static let shared = FileSystemManager()

// è·å–æ ¹ç›®å½•æ–‡ä»¶åˆ—è¡¨
func getRootFiles(for device: Device) -> [FileItem]

// è·å–å­ç›®å½•æ–‡ä»¶åˆ—è¡¨
func getChildrenFiles(for device: Device, parent: FileItem) -> [FileItem]

// æ¸…é™¤ç¼“å­˜
func clearCache(for device: Device)

// å¼ºåˆ¶æ¸…é™¤æ‰€æœ‰ç¼“å­˜
func forceClearCache()
```

**ç¼“å­˜ç­–ç•¥**:
- **ç¼“å­˜æ—¶é•¿**: 60ç§’
- **ç¼“å­˜é”®**: `(device.serialNumber, storageId, parentId)`
- **ç¼“å­˜æ¸…ç†**: è®¾å¤‡æ–­å¼€æ—¶è‡ªåŠ¨æ¸…ç†

#### 3. FileTransferManager (æ–‡ä»¶ä¼ è¾“ç®¡ç†å™¨)

**èŒè´£**:
- æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ç®¡ç†
- ä¼ è¾“ä»»åŠ¡è·Ÿè¸ª
- ä¼ è¾“è¿›åº¦ç®¡ç†
- ä»»åŠ¡å–æ¶ˆ

**å…³é”®æ–¹æ³•**:
```swift
// å•ä¾‹è®¿é—®
static let shared = FileTransferManager()

// ä¸Šä¼ æ–‡ä»¶
func uploadFile(to device: Device, sourceURL: URL, parentId: UInt32, storageId: UInt32)

// ä¸‹è½½æ–‡ä»¶
func downloadFile(from device: Device, fileItem: FileItem, to destinationURL: URL, shouldReplace: Bool)

// å–æ¶ˆä»»åŠ¡
func cancelTask(_ task: TransferTask)

// å–æ¶ˆæ‰€æœ‰ä»»åŠ¡
func cancelAllTasks()

// æ¸…é™¤å·²å®Œæˆä»»åŠ¡
func clearCompletedTasks()
```

**ä¼ è¾“ç‰¹æ€§**:
- **å¹¶å‘æ§åˆ¶**: ä¸²è¡Œé˜Ÿåˆ—ç¡®ä¿ä¼ è¾“é¡ºåº
- **é‡è¯•æœºåˆ¶**: ä¸‹è½½æœ€å¤š3æ¬¡é‡è¯•
- **è¿›åº¦è·Ÿè¸ª**: ä¼ è¾“å®Œæˆåä¸€æ¬¡æ€§æ›´æ–°è¿›åº¦ï¼ˆå®æ—¶è¿›åº¦å›è°ƒå·²ç¦ç”¨ä»¥ç¡®ä¿ç¨³å®šæ€§ï¼‰
- **å–æ¶ˆæ”¯æŒ**: æ”¯æŒä¸­é€”å–æ¶ˆä¼ è¾“

#### 4. LanguageManager (è¯­è¨€ç®¡ç†å™¨)

**èŒè´£**:
- è¯­è¨€çŠ¶æ€ç®¡ç†
- è¯­è¨€åˆ‡æ¢
- è¯­è¨€æŒä¹…åŒ–
- è¯­è¨€åŒ…åŠ è½½

**å…³é”®æ–¹æ³•**:
```swift
// å•ä¾‹è®¿é—®
static let shared = LanguageManager()

// å½“å‰è¯­è¨€
@Published var currentLanguage: AppLanguage

// åˆ‡æ¢è¯­è¨€
func setLanguage(_ language: AppLanguage)

// è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²
func localizedString(for key: String) -> String
```

**æ”¯æŒçš„è¯­è¨€**:
- `system` - ç³»ç»Ÿé»˜è®¤
- `english` - è‹±è¯­
- `chinese` - ç®€ä½“ä¸­æ–‡
- `japanese` - æ—¥è¯­
- `korean` - éŸ©è¯­

### æ•°æ®æµ

#### è®¾å¤‡æ£€æµ‹æµç¨‹

```
åº”ç”¨å¯åŠ¨
    â†“
DeviceManager.startScanning()
    â†“
å¯åŠ¨å®šæ—¶å™¨ (3ç§’é—´éš”)
    â†“
Kalam_Scan() [åå°é˜Ÿåˆ—]
    â†“
Go: withDeviceQuick()
    â†“
MTP: FetchDeviceInfo()
    â†“
MTP: FetchStorages()
    â†“
è¿”å› JSON
    â†“
JSONDecoder è§£ç 
    â†“
æ›´æ–° @Published devices [ä¸»çº¿ç¨‹]
    â†“
SwiftUI è‡ªåŠ¨åˆ·æ–° UI
```

#### æ–‡ä»¶æµè§ˆæµç¨‹

```
ç”¨æˆ·æµè§ˆæ–‡ä»¶å¤¹
    â†“
FileSystemManager.getChildrenFiles()
    â†“
æ£€æŸ¥ç¼“å­˜
    â†“
æœ‰ç¼“å­˜ä¸”æœªè¿‡æœŸ?
    â”œâ”€ æ˜¯ â†’ è¿”å›ç¼“å­˜æ•°æ®
    â””â”€ å¦ â†’ Kalam_ListFiles()
            â†“
        Go: withDevice()
            â†“
        MTP: GetObjectHandles()
            â†“
        MTP: GetObjectInfo() [éå†]
            â†“
        è¿”å› JSON
            â†“
        JSONDecoder è§£ç 
            â†“
        å­˜å…¥ç¼“å­˜ (60ç§’)
            â†“
        è¿”å›æ–‡ä»¶åˆ—è¡¨
```

#### æ–‡ä»¶ä¸‹è½½æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»ä¸‹è½½
    â†“
FileTransferManager.downloadFile()
    â†“
åˆ›å»º TransferTask
    â†“
æäº¤åˆ° transferQueue
    â†“
éªŒè¯ç›®æ ‡è·¯å¾„
    â†“
æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    â†“
éªŒè¯è®¾å¤‡è¿æ¥
    â†“
Kalam_DownloadFile()
    â†“
Go: withDevice()
    â†“
MTP: GetObjectInfo() [éªŒè¯]
    â†“
MTP: GetObject() [ä¸‹è½½]
    â†“
é‡è¯•æœºåˆ¶ (æœ€å¤š3æ¬¡)
    â†“
éªŒè¯ä¸‹è½½æ–‡ä»¶
    â†“
æ›´æ–°ä»»åŠ¡çŠ¶æ€
    â†“
ç§»åŠ¨åˆ° completedTasks
```

#### æ–‡ä»¶ä¸Šä¼ æµç¨‹

```
ç”¨æˆ·é€‰æ‹©ä¸Šä¼ æ–‡ä»¶
    â†“
FileTransferManager.uploadFile()
    â†“
7æ­¥è¾“å…¥éªŒè¯
    â†“
åˆ›å»º TransferTask
    â†“
æäº¤åˆ° transferQueue
    â†“
Kalam_UploadFile()
    â†“
Go: withDevice()
    â†“
MTP: SendObjectInfo() [å‘é€å…ƒæ•°æ®]
    â†“
MTP: SendObject() [å‘é€æ•°æ®]
    â†“
æ£€æŸ¥å–æ¶ˆçŠ¶æ€
    â†“
ä¸Šä¼ å®Œæˆ?
    â”œâ”€ æ˜¯ â†’ åˆ·æ–°å­˜å‚¨
    â”‚       â†“
    â”‚   é‡ç½®è®¾å¤‡ç¼“å­˜
    â”‚       â†“
    â”‚   æ¸…é™¤æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
    â”‚       â†“
    â”‚   å‘é€åˆ·æ–°é€šçŸ¥
    â””â”€ å¦ â†’ æ›´æ–°å¤±è´¥çŠ¶æ€
```

### çº¿ç¨‹æ¨¡å‹

SwiftMTP ä½¿ç”¨å¤šçº¿ç¨‹æ¨¡å‹ç¡®ä¿ UI å“åº”æ€§å’Œä¼ è¾“ç¨³å®šæ€§ã€‚

#### é˜Ÿåˆ—èŒè´£

| é˜Ÿåˆ— | ç±»å‹ | QoS | ç”¨é€” |
|------|------|-----|------|
| ä¸»çº¿ç¨‹ | ä¸²è¡Œ | - | UI æ›´æ–°ã€ç”¨æˆ·äº¤äº’ |
| å…¨å±€é˜Ÿåˆ— | å¹¶å‘ | `.userInitiated` | è®¾å¤‡æ‰«æã€æ–‡ä»¶åˆ—è¡¨è·å– |
| ä¼ è¾“é˜Ÿåˆ— | ä¸²è¡Œ | `.userInitiated` | æ–‡ä»¶ä¸‹è½½ã€æ–‡ä»¶ä¸Šä¼  |

#### çº¿ç¨‹åˆ‡æ¢æµç¨‹

```
ä¸»çº¿ç¨‹ (UI äº‹ä»¶)
    â†“
DispatchQueue.global(qos: .userInitiated).async
    â†“
åå°é˜Ÿåˆ—
    â†“
CGO è°ƒç”¨ (é˜»å¡)
    â†“
Go Runtime (åç¨‹)
    â†“
æ‰§è¡Œæ“ä½œ
    â†“
è¿”å›ç»“æœ
    â†“
DispatchQueue.main.async
    â†“
ä¸»çº¿ç¨‹ (æ›´æ–° UI)
```

#### çº¿ç¨‹å®‰å…¨æœºåˆ¶

1. **@Published å±æ€§**
   - SwiftUI è‡ªåŠ¨å¤„ç† UI æ›´æ–°
   - å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ›´æ–°

2. **ç¼“å­˜é”**
   - `FileSystemManager` ä½¿ç”¨ `NSLock`
   - ä¿æŠ¤æ–‡ä»¶ç¼“å­˜è¯»å†™

3. **ä»»åŠ¡é”**
   - `FileTransferManager` ä½¿ç”¨ `NSLock`
   - ä¿æŠ¤ `currentDownloadTask` è®¿é—®

4. **åŸå­æ“ä½œ**
   - `isCancelled` æ ‡å¿—
   - ä»»åŠ¡çŠ¶æ€æ›´æ–°

---

## ä½¿ç”¨æŒ‡å—

### ç¯å¢ƒè¦æ±‚

#### ç³»ç»Ÿè¦æ±‚

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| æ“ä½œç³»ç»Ÿ | macOS 26.0 æˆ–æ›´é«˜ |
| å¤„ç†å™¨ | Intel (x86_64) æˆ– Apple Silicon (M1/M2/M3) |
| å†…å­˜ | æœ€ä½ 4GB RAM |
| å­˜å‚¨ç©ºé—´ | 100MB å¯ç”¨ç©ºé—´ |

#### å¼€å‘ç¯å¢ƒ

| å·¥å…· | ç‰ˆæœ¬è¦æ±‚ |
|------|----------|
| Xcode | 26.0 æˆ–æ›´é«˜ |
| Swift | 5.9 æˆ–æ›´é«˜ |
| Go | 1.22 æˆ–æ›´é«˜ |
| Homebrew | æœ€æ–°ç‰ˆæœ¬ |

#### è¿è¡Œæ—¶ä¾èµ–

| åº“ | å®‰è£…å‘½ä»¤ |
|------|----------|
| Go | `brew install go` |

> ğŸ“ **è¯´æ˜**: libusb-1.0 ç°å·²æ‰“åŒ…åˆ°åº”ç”¨ä¸­ï¼Œæ— éœ€æ‰‹åŠ¨å®‰è£…ã€‚

### å®‰è£…æ­¥éª¤

#### æ–¹æ³• 1: ä»æºç æ„å»º

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/wang93wei/SwiftMTP.git
cd SwiftMTP

# 2. å®‰è£…ä¾èµ–
brew install go

# 3. æ„å»º Go æ¡¥æ¥å±‚
./Scripts/build_kalam.sh

# 4. åœ¨ Xcode ä¸­æ‰“å¼€é¡¹ç›®
open SwiftMTP.xcodeproj

# 5. è¿è¡Œé¡¹ç›®
# åœ¨ Xcode ä¸­ç‚¹å‡» Run æŒ‰é’® (âŒ˜ + R)
```

#### æ–¹æ³• 2: ä½¿ç”¨ DMG å®‰è£…åŒ…

```bash
# 1. ä¸‹è½½ DMG æ–‡ä»¶
# ä» GitHub Releases ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ DMG æ–‡ä»¶

# 2. æ‰“å¼€ DMG æ–‡ä»¶
# åŒå‡»ä¸‹è½½çš„ DMG æ–‡ä»¶

# 3. æ‹–æ‹½åº”ç”¨åˆ° Applications æ–‡ä»¶å¤¹
# å°† SwiftMTP.app æ‹–æ‹½åˆ° /Applications æ–‡ä»¶å¤¹

# 4. é¦–æ¬¡è¿è¡Œ
# å³é”®ç‚¹å‡»åº”ç”¨ â†’ æ‰“å¼€ â†’ ç¡®è®¤æ‰“å¼€
```

### å¿«é€Ÿå¼€å§‹

#### è¿æ¥è®¾å¤‡

1. **USB è¿æ¥**: ä½¿ç”¨ USB çº¿å°† Android è®¾å¤‡è¿æ¥åˆ° Mac
2. **é€‰æ‹© MTP æ¨¡å¼**: åœ¨ Android è®¾å¤‡ä¸Šé€‰æ‹© **æ–‡ä»¶ä¼ è¾“ (MTP)** æ¨¡å¼
3. **è‡ªåŠ¨æ£€æµ‹**: SwiftMTP ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ˜¾ç¤ºè®¾å¤‡

#### æµè§ˆæ–‡ä»¶

1. **æŸ¥çœ‹è®¾å¤‡åˆ—è¡¨**: ä¸»ç•Œé¢æ˜¾ç¤ºå·²è¿æ¥çš„è®¾å¤‡
2. **é€‰æ‹©è®¾å¤‡**: ç‚¹å‡»è®¾å¤‡è¿›å…¥æ–‡ä»¶æµè§ˆå™¨
3. **æµè§ˆæ–‡ä»¶å¤¹**: åŒå‡»æ–‡ä»¶å¤¹è¿›å…¥ï¼Œé¢åŒ…å±‘å¯¼èˆªè¿”å›ä¸Šçº§

#### ä¸‹è½½æ–‡ä»¶

1. **å•æ–‡ä»¶ä¸‹è½½**: å³é”®ç‚¹å‡»æ–‡ä»¶ â†’ **ä¸‹è½½**
2. **æ‰¹é‡ä¸‹è½½**: Command+Click å¤šé€‰æ–‡ä»¶ â†’ å³é”® â†’ **ä¸‹è½½æ‰€é€‰æ–‡ä»¶**
3. **æŸ¥çœ‹è¿›åº¦**: åœ¨ä¼ è¾“è§†å›¾ä¸­æŸ¥çœ‹ä¸‹è½½è¿›åº¦

#### ä¸Šä¼ æ–‡ä»¶

1. **æŒ‰é’®ä¸Šä¼ **: ç‚¹å‡»å·¥å…·æ  **ä¸Šä¼ æ–‡ä»¶** æŒ‰é’® â†’ é€‰æ‹©æ–‡ä»¶
2. **æ‹–æ”¾ä¸Šä¼ **: å°†æ–‡ä»¶æ‹–æ”¾åˆ°æ–‡ä»¶æµè§ˆå™¨çª—å£
3. **æŸ¥çœ‹è¿›åº¦**: åœ¨ä¼ è¾“è§†å›¾ä¸­æŸ¥çœ‹ä¸Šä¼ è¿›åº¦

### è¯¦ç»†æ“ä½œ

#### æ–‡ä»¶æ“ä½œ

| æ“ä½œ | æ–¹æ³• | å¿«æ·é”® |
|------|------|--------|
| è¿›å…¥æ–‡ä»¶å¤¹ | åŒå‡»æ–‡ä»¶å¤¹ | - |
| è¿”å›ä¸Šçº§ | ç‚¹å‡»é¢åŒ…å±‘å¯¼èˆª | - |
| é€‰æ‹©æ–‡ä»¶ | å•å‡»æ–‡ä»¶ | - |
| å¤šé€‰æ–‡ä»¶ | Command+Click | - |
| ä¸‹è½½æ–‡ä»¶ | å³é”® â†’ ä¸‹è½½ | - |
| åˆ·æ–°åˆ—è¡¨ | ç‚¹å‡»åˆ·æ–°æŒ‰é’® | âŒ˜ + R |

#### è®¾ç½®é€‰é¡¹

1. **æ‰“å¼€è®¾ç½®**: èœå•æ  â†’ SwiftMTP â†’ è®¾ç½® (âŒ˜ + ,)
2. **è¯­è¨€è®¾ç½®**:
   - é€‰æ‹©è¯­è¨€
   - ç³»ç»Ÿé»˜è®¤ / English / ä¸­æ–‡ / æ—¥æœ¬èª / í•œêµ­ì–´
   - åº”ç”¨å†…ç•Œé¢ç«‹å³æ›´æ–°
   - èœå•æ å’Œæ–‡ä»¶é€‰æ‹©å™¨éœ€è¦é‡å¯åº”ç”¨
3. **é‡å¯åº”ç”¨**: è®¾ç½®çª—å£ä¼šæç¤ºæ˜¯å¦ç«‹å³é‡å¯

#### è¯­è¨€åˆ‡æ¢

**æ–¹å¼ 1: èœå•æ **
1. èœå•æ  â†’ SwiftMTP â†’ Language
2. é€‰æ‹©è¯­è¨€
3. ç¡®è®¤æ˜¯å¦é‡å¯åº”ç”¨

**æ–¹å¼ 2: è®¾ç½®çª—å£**
1. æ‰“å¼€è®¾ç½®çª—å£ (âŒ˜ + ,)
2. é€‰æ‹©è¯­è¨€
3. ç¡®è®¤æ˜¯å¦é‡å¯åº”ç”¨

### é…ç½®é€‰é¡¹

#### åº”ç”¨é…ç½®

åº”ç”¨é…ç½®å­˜å‚¨åœ¨ `~/Library/Containers/com.wang93wei.SwiftMTP/Data/Library/Preferences/` ç›®å½•ã€‚

**è¯­è¨€è®¾ç½®**:
```swift
// UserDefaults é”®
"appLanguage" // è¯­è¨€åå¥½è®¾ç½®
```

**æ²™ç›’è¦æ±‚**:
- éœ€è¦ç¦ç”¨æ²™ç›’æ‰èƒ½è®¿é—® USB è®¾å¤‡
- åœ¨ Xcode é¡¹ç›®è®¾ç½®ä¸­ç¦ç”¨æ²™ç›’

---

## å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒæ­å»º

#### 1. å®‰è£… Xcode

```bash
# ä» App Store å®‰è£… Xcode
# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
xcode-select --install
```

#### 2. å®‰è£… Homebrew

```bash
# å®‰è£… Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# éªŒè¯å®‰è£…
brew --version
```

#### 3. å®‰è£…ä¾èµ–

```bash
# å®‰è£… Go
brew install go

# éªŒè¯å®‰è£…
go version
```

> ğŸ“ **è¯´æ˜**: libusb-1.0 å·²åœ¨æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨å®‰è£…ã€‚

#### 4. å…‹éš†é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/wang93wei/SwiftMTP.git
cd SwiftMTP

# æ£€æŸ¥ç¯å¢ƒ
./setup-check.sh
```

### æ„å»ºæµç¨‹

#### æ„å»º Go æ¡¥æ¥å±‚

```bash
# æ„å»ºåŠ¨æ€åº“
./Scripts/build_kalam.sh

# è¾“å‡ºæ–‡ä»¶
# SwiftMTP/libkalam.dylib
# SwiftMTP/libkalam.h
```

#### æ„å»º Swift åº”ç”¨

```bash
# ä½¿ç”¨ Xcode æ„å»º
xcodebuild -project SwiftMTP.xcodeproj \
  -scheme SwiftMTP \
  -configuration Debug

# æˆ–ä½¿ç”¨ Release é…ç½®
xcodebuild -project SwiftMTP.xcodeproj \
  -scheme SwiftMTP \
  -configuration Release
```

#### åˆ›å»º DMG å®‰è£…åŒ…

```bash
# ç®€åŒ–ç‰ˆæ‰“åŒ…ï¼ˆæ— éœ€å¼€å‘è€…è¯ä¹¦ï¼‰
./Scripts/create_dmg_simple.sh

# å®Œæ•´ç‰ˆæ‰“åŒ…ï¼ˆéœ€è¦å¼€å‘è€…è¯ä¹¦ï¼‰
./Scripts/create_dmg.sh

# è¾“å‡ºæ–‡ä»¶
# build/SwiftMTP-<version>.dmg
```

### ä»£ç è§„èŒƒ

#### Swift ä»£ç è§„èŒƒ

**å‘½åè§„èŒƒ**:
- ç±»å: `PascalCase` (å¦‚ `DeviceManager`)
- æ–¹æ³•å: `camelCase` (å¦‚ `startScanning`)
- å˜é‡å: `camelCase` (å¦‚ `selectedDevice`)
- å¸¸é‡å: `camelCase` (å¦‚ `maxRetries`)

**ä»£ç æ ¼å¼**:
- ä½¿ç”¨ 4 ç©ºæ ¼ç¼©è¿›
- æœ€å¤§è¡Œå®½: 120 å­—ç¬¦
- ä½¿ç”¨ç©ºæ ¼è€Œéåˆ¶è¡¨ç¬¦

**æ³¨é‡Šè§„èŒƒ**:
```swift
/// è®¾å¤‡ç®¡ç†å™¨
///
/// è´Ÿè´£è®¾å¤‡çš„è‡ªåŠ¨æ£€æµ‹ã€æ‰«æå’ŒçŠ¶æ€ç®¡ç†
class DeviceManager: ObservableObject {
    /// å¼€å§‹æ‰«æè®¾å¤‡
    func startScanning() {
        // å®ç°
    }
}
```

#### Go ä»£ç è§„èŒƒ

**å‘½åè§„èŒƒ**:
- åŒ…å: `lowercase` (å¦‚ `main`)
- å¯¼å‡ºå‡½æ•°: `PascalCase` (å¦‚ `Kalam_Scan`)
- ç§æœ‰å‡½æ•°: `camelCase` (å¦‚ `withDevice`)
- å¸¸é‡å: `PascalCase` (å¦‚ `QuickScanTimeout`)

**ä»£ç æ ¼å¼**:
```bash
# æ ¼å¼åŒ–ä»£ç 
go fmt ./...

# æ£€æŸ¥ä»£ç 
go vet ./...
```

### è°ƒè¯•æŠ€å·§

#### Xcode è°ƒè¯•

1. **è®¾ç½®æ–­ç‚¹**: åœ¨ä»£ç è¡Œå·å·¦ä¾§ç‚¹å‡»
2. **æŸ¥çœ‹å˜é‡**: é¼ æ ‡æ‚¬åœåœ¨å˜é‡ä¸Š
3. **æ§åˆ¶å°è¾“å‡º**: ä½¿ç”¨ `print()` æˆ– `NSLog()`
4. **LLDB å‘½ä»¤**: åœ¨æ§åˆ¶å°è¾“å…¥ LLDB å‘½ä»¤

#### æ—¥å¿—è¾“å‡º

**Swift æ—¥å¿—**:
```swift
import os

let logger = Logger(subsystem: "com.wang93wei.SwiftMTP", category: "DeviceManager")

logger.info("Starting device scan")
logger.error("Device scan failed: \(error.localizedDescription)")
```

**Go æ—¥å¿—**:
```go
import "fmt"

fmt.Printf("Kalam_Scan: Starting scan\n")
fmt.Printf("Kalam_Scan: Error: %v\n", err)
```

#### æ€§èƒ½åˆ†æ

```bash
# ä½¿ç”¨ Instruments åˆ†ææ€§èƒ½
# Xcode â†’ Product â†’ Profile (âŒ˜ + I)

# é€‰æ‹© Time Profiler
# è¿è¡Œåº”ç”¨å¹¶æ‰§è¡Œæ“ä½œ
# æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
```

---

## API æ–‡æ¡£

### CGO æ¡¥æ¥ API

Go æ¡¥æ¥å±‚æä¾›çš„ C æ¥å£å‡½æ•°ã€‚

#### åˆå§‹åŒ–å‡½æ•°

```c
// åˆå§‹åŒ– Kalam Kernel
void Kalam_Init();
```

#### è®¾å¤‡ç®¡ç†

```c
// æ‰«æè®¾å¤‡
// è¿”å›: JSON å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œå¤±è´¥è¿”å› nil
char* Kalam_Scan();

// é‡Šæ”¾å­—ç¬¦ä¸²å†…å­˜
void Kalam_FreeString(char* str);
```

#### æ–‡ä»¶æ“ä½œ

```c
// åˆ—å‡ºæ–‡ä»¶
// storageID: å­˜å‚¨ID
// parentID: çˆ¶ç›®å½•ID
// è¿”å›: JSON å­—ç¬¦ä¸²æŒ‡é’ˆï¼Œå¤±è´¥è¿”å› nil
char* Kalam_ListFiles(uint32_t storageID, uint32_t parentID);

// åˆ›å»ºæ–‡ä»¶å¤¹
// storageID: å­˜å‚¨ID
// parentID: çˆ¶ç›®å½•ID
// folderName: æ–‡ä»¶å¤¹åç§°
// è¿”å›: æ–°æ–‡ä»¶å¤¹çš„å¥æŸ„ï¼Œå¤±è´¥è¿”å› 0
uint32_t Kalam_CreateFolder(uint32_t storageID, uint32_t parentID, char* folderName);

// åˆ é™¤å¯¹è±¡
// objectID: å¯¹è±¡ID
// è¿”å›: æˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0
int32_t Kalam_DeleteObject(uint32_t objectID);
```

#### æ–‡ä»¶ä¼ è¾“

```c
// ä¸‹è½½æ–‡ä»¶
// objectID: å¯¹è±¡ID
// destinationPath: ç›®æ ‡è·¯å¾„
// taskID: ä»»åŠ¡ID
// è¿”å›: æˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0
int32_t Kalam_DownloadFile(uint32_t objectID, char* destinationPath, char* taskID);

// ä¸Šä¼ æ–‡ä»¶
// storageID: å­˜å‚¨ID
// parentID: çˆ¶ç›®å½•ID
// sourcePath: æºæ–‡ä»¶è·¯å¾„
// taskID: ä»»åŠ¡ID
// è¿”å›: æˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0
int32_t Kalam_UploadFile(uint32_t storageID, uint32_t parentID, char* sourcePath, char* taskID);
```

#### ä»»åŠ¡ç®¡ç†

```c
// å–æ¶ˆä»»åŠ¡
// taskID: ä»»åŠ¡ID
void Kalam_CancelTask(char* taskID);

// è®¾ç½®è¿›åº¦å›è°ƒï¼ˆå·²ç¦ç”¨ï¼‰
// cb: å›è°ƒå‡½æ•°æŒ‡é’ˆ
void Kalam_SetProgressCallback(uintptr_t cb);
```

#### ç¼“å­˜ç®¡ç†

```c
// åˆ·æ–°å­˜å‚¨
// storageID: å­˜å‚¨ID
// è¿”å›: æˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0
int32_t Kalam_RefreshStorage(uint32_t storageID);

// é‡ç½®è®¾å¤‡ç¼“å­˜
// è¿”å›: æˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0
int32_t Kalam_ResetDeviceCache();
```

### Swift æœåŠ¡å±‚ API

#### DeviceManager

```swift
class DeviceManager: ObservableObject {
    // å•ä¾‹
    static let shared = DeviceManager()
    
    // å‘å¸ƒçš„å±æ€§
    @Published var devices: [Device] = []
    @Published var selectedDevice: Device?
    @Published var isScanning: Bool = false
    @Published var showManualRefreshButton: Bool = false
    
    // æ–¹æ³•
    func startScanning()
    func stopScanning()
    func manualRefresh()
    func handleDeviceDisconnection()
}
```

#### FileSystemManager

```swift
class FileSystemManager: ObservableObject {
    // å•ä¾‹
    static let shared = FileSystemManager()
    
    // æ–¹æ³•
    func getRootFiles(for device: Device) -> [FileItem]
    func getChildrenFiles(for device: Device, parent: FileItem) -> [FileItem]
    func clearCache(for device: Device)
    func forceClearCache()
}
```

#### FileTransferManager

```swift
class FileTransferManager: ObservableObject {
    // å•ä¾‹
    static let shared = FileTransferManager()
    
    // å‘å¸ƒçš„å±æ€§
    @Published var activeTasks: [TransferTask] = []
    @Published var completedTasks: [TransferTask] = []
    
    // æ–¹æ³•
    func uploadFile(to device: Device, sourceURL: URL, parentId: UInt32, storageId: UInt32)
    func downloadFile(from device: Device, fileItem: FileItem, to destinationURL: URL, shouldReplace: Bool)
    func cancelTask(_ task: TransferTask)
    func cancelAllTasks()
    func clearCompletedTasks()
}
```

#### LanguageManager

```swift
class LanguageManager: ObservableObject {
    // å•ä¾‹
    static let shared = LanguageManager()
    
    // å‘å¸ƒçš„å±æ€§
    @Published var currentLanguage: AppLanguage = .system
    
    // æ–¹æ³•
    func setLanguage(_ language: AppLanguage)
    func localizedString(for key: String) -> String
}
```

### æ•°æ®æ¨¡å‹

#### Device

```swift
struct Device: Identifiable, Hashable {
    let id: UUID
    let deviceIndex: Int
    let name: String
    let manufacturer: String
    let model: String
    let serialNumber: String
    let batteryLevel: Int?
    var storageInfo: [StorageInfo]
    var mtpSupportInfo: MTPSupportInfo?
    var isConnected: Bool
    
    // è®¡ç®—å±æ€§
    var displayName: String
    var displayModel: String
    var totalCapacity: UInt64
    var totalFreeSpace: UInt64
}
```

#### FileItem

```swift
struct FileItem: Identifiable, Hashable, Comparable {
    let id: UUID
    let objectId: UInt32
    let parentId: UInt32
    let storageId: UInt32
    let name: String
    let path: String
    let size: UInt64
    let modifiedDate: Date?
    let isDirectory: Bool
    let fileType: String
    var children: [FileItem]?
    
    // è®¡ç®—å±æ€§
    var fileExtension: String
    var formattedSize: String
    var formattedDate: String
    var sortableDate: Date
}
```

#### TransferTask

```swift
struct TransferTask: Identifiable {
    let id: UUID
    let type: TransferType
    let fileName: String
    let fileSize: UInt64
    let sourcePath: String
    let destinationPath: String
    var transferredBytes: UInt64
    var status: TransferStatus
    var error: String?
    var startTime: Date
    var endTime: Date?
    var isCancelled: Bool
    
    // è®¡ç®—å±æ€§
    var progress: Double
    var formattedProgress: String
    var speed: String
    var estimatedTimeRemaining: String
}
```

---

## å¸¸è§é—®é¢˜è§£ç­” (FAQ)

### å®‰è£…å’Œè®¾ç½®

**Q: ä¸ºä»€ä¹ˆéœ€è¦ç¦ç”¨æ²™ç›’ï¼Ÿ**

A: macOS æ²™ç›’æœºåˆ¶ä¼šé˜»æ­¢åº”ç”¨è®¿é—® USB è®¾å¤‡ã€‚SwiftMTP éœ€è¦é€šè¿‡ libusb-1.0 ç›´æ¥ä¸ Android è®¾å¤‡é€šä¿¡ï¼Œå› æ­¤å¿…é¡»ç¦ç”¨æ²™ç›’ã€‚

**Q: å¦‚ä½•ç¦ç”¨æ²™ç›’ï¼Ÿ**

A: åœ¨ Xcode é¡¹ç›®è®¾ç½®ä¸­ï¼š
1. é€‰æ‹© SwiftMTP target
2. è¿›å…¥ Signing & Capabilities æ ‡ç­¾
3. å–æ¶ˆå‹¾é€‰ App Sandbox

**Q: åº”ç”¨æ— æ³•å¯åŠ¨æ€ä¹ˆåŠï¼Ÿ**

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®ä¿å·²æ„å»º Go æ¡¥æ¥å±‚: `./Scripts/build_kalam.sh`
2. æ£€æŸ¥ libkalam.dylib æ˜¯å¦å­˜åœ¨: `ls SwiftMTP/libkalam.dylib`
3. æ£€æŸ¥ libusb-1.0.dylib æ˜¯å¦å­˜åœ¨: `ls SwiftMTP/libusb-1.0.dylib`

### è®¾å¤‡è¿æ¥

**Q: è®¾å¤‡æœªè¢«æ£€æµ‹åˆ°æ€ä¹ˆåŠï¼Ÿ**

A: å°è¯•ä»¥ä¸‹æ­¥éª¤ï¼š
1. ç¡®ä¿è®¾å¤‡å·²å¼€å¯ MTP æ¨¡å¼
2. å°è¯•æ–­å¼€é‡è¿ USB çº¿
3. é‡å¯åº”ç”¨
4. æ£€æŸ¥ USB çº¿æ˜¯å¦æ”¯æŒæ•°æ®ä¼ è¾“
5. ç‚¹å‡»æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®

**Q: ä¸ºä»€ä¹ˆéœ€è¦é€‰æ‹© MTP æ¨¡å¼ï¼Ÿ**

A: Android è®¾å¤‡æœ‰å¤šç§ USB è¿æ¥æ¨¡å¼ï¼š
- **MTP (Media Transfer Protocol)**: æ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒSwiftMTP ä½¿ç”¨æ­¤æ¨¡å¼
- **PTP (Picture Transfer Protocol)**: ä»…ç”¨äºç…§ç‰‡ä¼ è¾“
- **å……ç”µæ¨¡å¼**: ä»…å……ç”µï¼Œä¸ä¼ è¾“æ•°æ®
- **USB è°ƒè¯•æ¨¡å¼**: ç”¨äºå¼€å‘è°ƒè¯•

**Q: æ”¯æŒå“ªäº› Android è®¾å¤‡ï¼Ÿ**

A: SwiftMTP æ”¯æŒæ‰€æœ‰è¿è¡Œ Android 4.0+ å¹¶æ”¯æŒ MTP åè®®çš„è®¾å¤‡ã€‚åŒ…æ‹¬ï¼š
- Samsung Galaxy ç³»åˆ—
- Google Pixel ç³»åˆ—
- OnePlus ç³»åˆ—
- å°ç±³ã€åä¸ºã€OPPOã€vivo ç­‰å“ç‰Œè®¾å¤‡

### æ–‡ä»¶ä¼ è¾“

**Q: ä¸ºä»€ä¹ˆä¼ è¾“é€Ÿåº¦è¾ƒæ…¢ï¼Ÿ**

A: MTP åè®®æœ¬èº«çš„é™åˆ¶ï¼š
- MTP æ˜¯åŸºäº USB çš„åè®®ï¼Œä¼ è¾“é€Ÿåº¦å— USB ç‰ˆæœ¬é™åˆ¶
- USB 2.0: æœ€é«˜ 480 Mbps (çº¦ 60 MB/s)
- USB 3.0+: æœ€é«˜ 5 Gbps (çº¦ 625 MB/s)
- å®é™…é€Ÿåº¦è¿˜å—è®¾å¤‡æ€§èƒ½å’Œæ–‡ä»¶ç³»ç»Ÿå½±å“

**Q: æ”¯æŒå¤§æ–‡ä»¶ä¼ è¾“å—ï¼Ÿ**

A: æ”¯æŒï¼ŒSwiftMTP å¯ä»¥ä¼ è¾“ >4GB çš„å¤§æ–‡ä»¶ã€‚ä½†éœ€è¦æ³¨æ„ï¼š
- è®¾å¤‡å­˜å‚¨ç©ºé—´æ˜¯å¦è¶³å¤Ÿ
- ä¼ è¾“å¤§æ–‡ä»¶å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
- ç¡®ä¿è®¾å¤‡åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸æ–­å¼€è¿æ¥

**Q: ä¼ è¾“ä¸­æ–­äº†æ€ä¹ˆåŠï¼Ÿ**

A: SwiftMTP æä¾›è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼š
- ä¸‹è½½å¤±è´¥ä¼šè‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼‰
- å¦‚æœæ‰€æœ‰é‡è¯•éƒ½å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨é‡è¯•
- ç¡®ä¿è®¾å¤‡è¿æ¥ç¨³å®šåå†ä¼ è¾“

**Q: ä¸ºä»€ä¹ˆä¸Šä¼ åæ–‡ä»¶åˆ—è¡¨æ²¡æœ‰åˆ·æ–°ï¼Ÿ**

A: SwiftMTP ä¼šè‡ªåŠ¨åˆ·æ–°æ–‡ä»¶åˆ—è¡¨ï¼Œä½†å¯èƒ½éœ€è¦å‡ ç§’é’Ÿæ—¶é—´ã€‚å¦‚æœé•¿æ—¶é—´æœªåˆ·æ–°ï¼š
1. ç‚¹å‡»åˆ·æ–°æŒ‰é’®
2. è¿”å›ä¸Šçº§ç›®å½•å†é‡æ–°è¿›å…¥
3. é‡å¯åº”ç”¨

### è¯­è¨€å’Œæœ¬åœ°åŒ–

**Q: å¦‚ä½•åˆ‡æ¢åº”ç”¨è¯­è¨€ï¼Ÿ**

A: æœ‰ä¸¤ç§æ–¹å¼ï¼š
1. **èœå•æ **: SwiftMTP â†’ Language â†’ é€‰æ‹©è¯­è¨€
2. **è®¾ç½®çª—å£**: âŒ˜ + , â†’ é€‰æ‹©è¯­è¨€

**Q: ä¸ºä»€ä¹ˆèœå•æ å’Œæ–‡ä»¶é€‰æ‹©å™¨æ²¡æœ‰ç«‹å³åˆ‡æ¢è¯­è¨€ï¼Ÿ**

A: è¿™äº›ç³»ç»Ÿç»„ä»¶éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½ç”Ÿæ•ˆã€‚åˆ‡æ¢è¯­è¨€æ—¶ä¼šæç¤ºæ˜¯å¦ç«‹å³é‡å¯ã€‚

**Q: å¦‚ä½•æ·»åŠ æ–°çš„è¯­è¨€æ”¯æŒï¼Ÿ**

A: éœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š
1. åœ¨ `SwiftMTP/Resources/` åˆ›å»ºæ–°çš„ `.lproj` ç›®å½•
2. å¤åˆ¶ `Localizable.strings` å’Œ `InfoPlist.strings`
3. ç¿»è¯‘æ‰€æœ‰å­—ç¬¦ä¸²
4. åœ¨ `AppLanguage.swift` æ·»åŠ æ–°çš„è¯­è¨€æšä¸¾
5. åœ¨ `LanguageManager.swift` æ·»åŠ è¯­è¨€åŒ…åŠ è½½é€»è¾‘

### æ€§èƒ½å’Œç¨³å®šæ€§

**Q: åº”ç”¨å ç”¨å†…å­˜è¿‡é«˜æ€ä¹ˆåŠï¼Ÿ**

A: SwiftMTP çš„å†…å­˜å ç”¨é€šå¸¸åœ¨ 50-100MB ä¹‹é—´ã€‚å¦‚æœå ç”¨è¿‡é«˜ï¼š
1. æ¸…é™¤å·²å®Œæˆä»»åŠ¡
2. é‡å¯åº”ç”¨
3. æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡æ–‡ä»¶ç¼“å­˜

**Q: è®¾å¤‡æ‰«æé¢‘ç¹å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

A: SwiftMTP ä½¿ç”¨æŒ‡æ•°é€€é¿ç­–ç•¥ä¼˜åŒ–æ‰«æï¼š
- åˆå§‹é—´éš”: ç”¨æˆ·è®¾ç½®çš„å€¼ï¼ˆé»˜è®¤3ç§’ï¼‰
- å¤±è´¥åé—´éš”: userScanInterval Ã— 2^failures (æœ€å¤§30ç§’)
- è¿ç»­å¤±è´¥3æ¬¡åæ˜¾ç¤ºæ‰‹åŠ¨åˆ·æ–°æŒ‰é’®
- å¯åœ¨è®¾ç½®ä¸­è°ƒæ•´æ‰«æé—´éš”ï¼ˆ1-10ç§’ï¼‰

**Q: å¦‚ä½•æé«˜ä¼ è¾“ç¨³å®šæ€§ï¼Ÿ**

A: å»ºè®®ï¼š
1. ä½¿ç”¨é«˜è´¨é‡çš„ USB çº¿
2. ç¡®ä¿è®¾å¤‡ç”µé‡å……è¶³
3. é¿å…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ“ä½œè®¾å¤‡
4. å…³é—­å…¶ä»–å ç”¨ USB çš„åº”ç”¨

### å·²çŸ¥é™åˆ¶

**Q: ä¸ºä»€ä¹ˆä¸æ”¯æŒæ–‡ä»¶å¤¹ä¸Šä¼ ï¼Ÿ**

A: å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒå•æ–‡ä»¶ä¸Šä¼ ã€‚æ–‡ä»¶å¤¹ä¸Šä¼ åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ã€‚

**Q: ä¸ºä»€ä¹ˆä»…æ”¯æŒå•ä¸ªè®¾å¤‡ï¼Ÿ**

A: MTP åè®®çš„é™åˆ¶å’Œç®€åŒ–å®ç°ã€‚å¤šè®¾å¤‡æ”¯æŒåŠŸèƒ½åœ¨è®¡åˆ’ä¸­ã€‚

**Q: ä¸ºä»€ä¹ˆè¿›åº¦å›è°ƒè¢«ç¦ç”¨ï¼Ÿ**

A: ä¸ºäº†æé«˜ç¨³å®šæ€§ï¼Œè¿›åº¦å›è°ƒåŠŸèƒ½å·²è¢«ç¦ç”¨ã€‚ä¼ è¾“å®Œæˆåä¼šä¸€æ¬¡æ€§æ˜¾ç¤ºå®ŒæˆçŠ¶æ€ã€‚

---

## æ•…éšœæ’é™¤

### è®¾å¤‡è¿æ¥é—®é¢˜

#### ç—‡çŠ¶: è®¾å¤‡æœªæ£€æµ‹åˆ°

**è¯Šæ–­æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ USB è®¾å¤‡æ˜¯å¦è¢«è¯†åˆ«
system_profiler SPUSBDataType | grep -i android

# 2. æ£€æŸ¥åº”ç”¨æ—¥å¿—
# Console.app â†’ é€‰æ‹© SwiftMTP â†’ æŸ¥çœ‹æ—¥å¿—
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥ USB è¿æ¥**:
   - æ›´æ¢ USB çº¿
   - å°è¯•ä¸åŒçš„ USB ç«¯å£
   - ç¡®ä¿ä½¿ç”¨æ•°æ®çº¿è€Œéä»…å……ç”µçº¿

2. **æ£€æŸ¥è®¾å¤‡è®¾ç½®**:
   - ç¡®è®¤è®¾å¤‡å·²å¼€å¯ MTP æ¨¡å¼
   - å°è¯•å…³é—­å†å¼€å¯ USB è°ƒè¯•
   - é‡å¯ Android è®¾å¤‡

3. **æ£€æŸ¥åº”ç”¨é…ç½®**:
   - ç¡®ä¿å·²ç¦ç”¨æ²™ç›’
   - é‡æ–°æ„å»ºåº”ç”¨

#### ç—‡çŠ¶: è®¾å¤‡é¢‘ç¹æ–­å¼€

**è¯Šæ–­æ­¥éª¤**:

```bash
# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
log show --predicate 'process == "SwiftMTP"' --last 10m

# æ£€æŸ¥ USB ç”µæºç®¡ç†
pmset -g | grep usb
```

**è§£å†³æ–¹æ¡ˆ**:

1. **ç¦ç”¨ USB ç”µæºç®¡ç†**:
```bash
# ä¸´æ—¶ç¦ç”¨
sudo pmset -a disablesleep 1

# æ°¸ä¹…ç¦ç”¨ï¼ˆä¸æ¨èï¼‰
# ç³»ç»Ÿåå¥½è®¾ç½® â†’ èŠ‚èƒ½ â†’ å–æ¶ˆå‹¾é€‰"å½“ä½¿ç”¨ç”µæºé€‚é…å™¨ä¾›ç”µæ—¶é˜²æ­¢ç”µè„‘è‡ªåŠ¨ç¡çœ "
```

2. **ä½¿ç”¨ USB é›†çº¿å™¨**:
   - ä½¿ç”¨å¸¦ç‹¬ç«‹ä¾›ç”µçš„ USB é›†çº¿å™¨
   - é¿å…ç›´æ¥è¿æ¥ Mac çš„ USB ç«¯å£

### æ–‡ä»¶ä¼ è¾“é—®é¢˜

#### ç—‡çŠ¶: ä¸‹è½½å¤±è´¥

**è¯Šæ–­æ­¥éª¤**:

```bash
# æ£€æŸ¥ç›®æ ‡ç›®å½•æƒé™
ls -la ~/Downloads/

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
# Console.app â†’ é€‰æ‹© SwiftMTP â†’ æŸ¥çœ‹é”™è¯¯æ—¥å¿—
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥ç›®æ ‡è·¯å¾„**:
   - ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨
   - ç¡®ä¿æœ‰å†™å…¥æƒé™
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´

2. **æ£€æŸ¥è®¾å¤‡è¿æ¥**:
   - ç¡®ä¿è®¾å¤‡è¿æ¥ç¨³å®š
   - é¿å…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ“ä½œè®¾å¤‡

3. **é‡è¯•ä¼ è¾“**:
   - SwiftMTP ä¼šè‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼‰
   - å¦‚æœæ‰€æœ‰é‡è¯•éƒ½å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨é‡è¯•

#### ç—‡çŠ¶: ä¸Šä¼ å¤±è´¥

**è¯Šæ–­æ­¥éª¤**:

```bash
# æ£€æŸ¥æºæ–‡ä»¶
ls -lh /path/to/source/file

# æ£€æŸ¥æ–‡ä»¶å¤§å°
stat -f%z /path/to/source/file

# æ£€æŸ¥è®¾å¤‡å­˜å‚¨ç©ºé—´
# åœ¨åº”ç”¨ä¸­æŸ¥çœ‹è®¾å¤‡å­˜å‚¨ä¿¡æ¯
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥æºæ–‡ä»¶**:
   - ç¡®ä¿æ–‡ä»¶å­˜åœ¨
   - ç¡®ä¿ä¸æ˜¯ç›®å½•
   - ç¡®ä¿æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 10GB

2. **æ£€æŸ¥è®¾å¤‡å­˜å‚¨**:
   - ç¡®ä¿è®¾å¤‡æœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´
   - æ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒè¯¥æ–‡ä»¶ç±»å‹

3. **æ£€æŸ¥è·¯å¾„**:
   - ç¡®ä¿è·¯å¾„ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦
   - ç¡®ä¿è·¯å¾„ä¸åŒ…å«ç¬¦å·é“¾æ¥

### ç¼–è¯‘é—®é¢˜

#### ç—‡çŠ¶: Go æ¡¥æ¥å±‚æ„å»ºå¤±è´¥

**è¯Šæ–­æ­¥éª¤**:

```bash
# æ£€æŸ¥ Go ç‰ˆæœ¬
go version

# æ£€æŸ¥ Go æ¨¡å—
cd Native
go mod verify

# å°è¯•æ‰‹åŠ¨æ„å»º
go build -buildmode=c-shared -o ../SwiftMTP/libkalam.dylib .
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ›´æ–° Go**:
```bash
brew upgrade go
```

2. **æ¸…ç†å¹¶é‡æ–°æ„å»º**:
```bash
cd Native
go clean -cache
go mod download
./../Scripts/build_kalam.sh
```

3. **æ£€æŸ¥ä¾èµ–**:
```bash
cd Native
go mod tidy
```

#### ç—‡çŠ¶: Swift ç¼–è¯‘å¤±è´¥

**è¯Šæ–­æ­¥éª¤**:

```bash
# æ¸…ç†æ„å»º
xcodebuild clean

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
xcodebuild -project SwiftMTP.xcodeproj -scheme SwiftMTP -configuration Debug 2>&1 | grep error
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ¸…ç†å¹¶é‡æ–°æ„å»º**:
```bash
xcodebuild clean
xcodebuild -project SwiftMTP.xcodeproj -scheme SwiftMTP -configuration Debug
```

2. **æ£€æŸ¥ Xcode ç‰ˆæœ¬**:
   - ç¡®ä¿ä½¿ç”¨ Xcode 26.0 æˆ–æ›´é«˜ç‰ˆæœ¬

3. **æ£€æŸ¥ Swift ç‰ˆæœ¬**:
   - ç¡®ä¿é¡¹ç›®ä½¿ç”¨ Swift 5.9 æˆ–æ›´é«˜ç‰ˆæœ¬

### æ€§èƒ½é—®é¢˜

#### ç—‡çŠ¶: åº”ç”¨å“åº”ç¼“æ…¢

**è¯Šæ–­æ­¥éª¤**:

```bash
# ä½¿ç”¨ Instruments åˆ†ææ€§èƒ½
# Xcode â†’ Product â†’ Profile (âŒ˜ + I)

# æ£€æŸ¥ CPU ä½¿ç”¨ç‡
top -pid $(pgrep SwiftMTP)

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
ps aux | grep SwiftMTP
```

**è§£å†³æ–¹æ¡ˆ**:

1. **ä¼˜åŒ–æ–‡ä»¶åˆ—è¡¨ç¼“å­˜**:
   - å‡å°‘ç¼“å­˜æ—¶é—´
   - æ¸…é™¤ä¸å¿…è¦çš„ç¼“å­˜

2. **ä¼˜åŒ–æ‰«æé¢‘ç‡**:
   - è°ƒæ•´æ‰«æé—´éš”
   - ä½¿ç”¨æ‰‹åŠ¨åˆ·æ–°

3. **å…³é—­ä¸å¿…è¦çš„åŠŸèƒ½**:
   - ç¦ç”¨è‡ªåŠ¨åˆ·æ–°
   - å‡å°‘åå°ä»»åŠ¡

---

## è´¡çŒ®æŒ‡å—

### å¦‚ä½•è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼

#### æŠ¥å‘Š Bug

1. åœ¨ [GitHub Issues](https://github.com/wang93wei/SwiftMTP/issues) æœç´¢ç°æœ‰é—®é¢˜
2. å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ›å»ºæ–°çš„ Issue
3. æä¾›è¯¦ç»†ä¿¡æ¯ï¼š
   - macOS ç‰ˆæœ¬
   - SwiftMTP ç‰ˆæœ¬
   - Android è®¾å¤‡å‹å·å’Œç³»ç»Ÿç‰ˆæœ¬
   - é‡ç°æ­¥éª¤
   - é¢„æœŸè¡Œä¸ºå’Œå®é™…è¡Œä¸º
   - é”™è¯¯æ—¥å¿—ï¼ˆå¦‚æœ‰ï¼‰

#### æå‡ºæ–°åŠŸèƒ½

1. åœ¨ [GitHub Issues](https://github.com/wang93wei/SwiftMTP/issues) åˆ›å»º Feature Request
2. è¯¦ç»†æè¿°åŠŸèƒ½éœ€æ±‚
3. è¯´æ˜ä½¿ç”¨åœºæ™¯å’Œé¢„æœŸæ•ˆæœ
4. æä¾›è®¾è®¡è‰å›¾æˆ–åŸå‹ï¼ˆå¦‚æœ‰ï¼‰

#### æäº¤ä»£ç 

1. **Fork é¡¹ç›®**:
   ```bash
   # åœ¨ GitHub ä¸Š Fork é¡¹ç›®
   git clone https://github.com/YOUR_USERNAME/SwiftMTP.git
   cd SwiftMTP
   ```

2. **åˆ›å»ºåˆ†æ”¯**:
   ```bash
   git checkout -b feature/your-feature-name
   # æˆ–
   git checkout -b fix/your-bug-fix
   ```

3. **ç¼–å†™ä»£ç **:
   - éµå¾ªä»£ç è§„èŒƒ
   - æ·»åŠ å¿…è¦çš„æ³¨é‡Š
   - ç¼–å†™å•å…ƒæµ‹è¯•

4. **æµ‹è¯•ä»£ç **:
   ```bash
   # è¿è¡Œæµ‹è¯•
   ./Scripts/run_tests.sh

   # æ„å»ºåº”ç”¨
   xcodebuild -project SwiftMTP.xcodeproj -scheme SwiftMTP -configuration Debug
   ```

5. **æäº¤æ›´æ”¹**:
   ```bash
   git add .
   git commit -m "feat: add your feature description"
   # æˆ–
   git commit -m "fix: fix bug description"
   ```

6. **æ¨é€åˆ†æ”¯**:
   ```bash
   git push origin feature/your-feature-name
   ```

7. **åˆ›å»º Pull Request**:
   - åœ¨ GitHub ä¸Šåˆ›å»º Pull Request
   - å¡«å†™ PR æ¨¡æ¿
   - ç­‰å¾…ä»£ç å®¡æŸ¥

### ä»£ç å®¡æŸ¥å‡†åˆ™

- **ä»£ç è´¨é‡**: ä»£ç æ¸…æ™°ã€æ˜“è¯»ã€å¯ç»´æŠ¤
- **æµ‹è¯•è¦†ç›–**: æ–°åŠŸèƒ½å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- **æ–‡æ¡£å®Œæ•´**: æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
- **æ€§èƒ½è€ƒè™‘**: é¿å…æ€§èƒ½é—®é¢˜
- **å…¼å®¹æ€§**: ç¡®ä¿å‘åå…¼å®¹

### å¼€å‘æµç¨‹

1. **å¢é‡å¼€å‘**: å°æ­¥å¿«è·‘ï¼Œé¢‘ç¹æäº¤
2. **ç¼–è¯‘éªŒè¯**: æ¯æ¬¡æäº¤å‰ç¡®ä¿ç¼–è¯‘é€šè¿‡
3. **æµ‹è¯•é€šè¿‡**: ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
4. **ä»£ç å®¡æŸ¥**: æäº¤ PR è¿›è¡Œä»£ç å®¡æŸ¥
5. **åˆå¹¶ä»£ç **: å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ°ä¸»åˆ†æ”¯

---

## æ›´æ–°æ—¥å¿—

### ç‰ˆæœ¬ 1.0.0 (2025-12-31)

#### æ–°åŠŸèƒ½

- âœ… è®¾å¤‡è‡ªåŠ¨æ£€æµ‹å’Œæ‰«æ
- âœ… æ–‡ä»¶æµè§ˆå’Œå¯¼èˆª
- âœ… æ–‡ä»¶ä¸‹è½½ï¼ˆæ”¯æŒ >4GBï¼‰
- âœ… æ–‡ä»¶ä¸Šä¼ ï¼ˆæŒ‰é’®å’Œæ‹–æ”¾ï¼‰
- âœ… æ‰¹é‡æ–‡ä»¶æ“ä½œ
- âœ… å¤šè¯­è¨€æ”¯æŒï¼ˆä¸­/è‹±/æ—¥/éŸ©ï¼‰
- âœ… å­˜å‚¨ä¿¡æ¯æ˜¾ç¤º
- âœ… ç°ä»£åŒ– SwiftUI ç•Œé¢

#### æŠ€æœ¯ç‰¹æ€§

- âœ… MVVM æ¶æ„
- âœ… Combine å“åº”å¼ç¼–ç¨‹
- âœ… CGO æ¡¥æ¥ï¼ˆSwift â†” Goï¼‰
- âœ… MTP åè®®å®ç°
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… è‡ªåŠ¨é‡è¯•æœºåˆ¶
- âœ… ç¼“å­˜ä¼˜åŒ–
- âœ… çº¿ç¨‹å®‰å…¨

#### å·²çŸ¥é™åˆ¶

- âš ï¸ éœ€è¦ç¦ç”¨æ²™ç›’
- âš ï¸ ä»…æ”¯æŒå•ä¸ªè®¾å¤‡
- âš ï¸ ä»…æ”¯æŒå•æ–‡ä»¶ä¸Šä¼ 
- âš ï¸ è¿›åº¦å›è°ƒå·²ç¦ç”¨

---

## é™„å½•

### å‚è€ƒèµ„æ–™

- [SwiftUI Documentation](https://developer.apple.com/documentation/swiftui)
- [Combine Framework](https://developer.apple.com/documentation/combine)
- [CGO Documentation](https://pkg.go.dev/cmd/cgo)
- [MTP Protocol](https://en.wikipedia.org/wiki/Media_Transfer_Protocol)
- [libusb Documentation](https://libusb.info/)

### ç›¸å…³é¡¹ç›®

- [go-mtpx](https://github.com/ganeshrvel/go-mtpx) - Go MTP åè®®å®ç°
- [libmtp](http://libmtp.sourceforge.net/) - C è¯­è¨€ MTP åº“
- [android-file-transfer](https://github.com/whooie/java-android-file-transfer) - Java Android æ–‡ä»¶ä¼ è¾“

### è”ç³»æ–¹å¼

- **GitHub**: https://github.com/wang93wei/SwiftMTP
- **Issues**: https://github.com/wang93wei/SwiftMTP/issues
- **Email**: wang93wei@gmail.com

### è®¸å¯è¯

MIT License

Copyright (c) 2025 wang93wei

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

---

**æœ€åæ›´æ–°**: 2026å¹´1æœˆ1æ—¥

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
